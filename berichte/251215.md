Name: Lisa Hintermaier     
Datum: 15.12.2025     
Fach: ITSE - Übungen    
Klasse: 4AHITS    

# Vulnerability Scanning  

## Übung (Optionen)    
Analysiere die Bedeutung der folgenden Optionen:   
`$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153`   
Was führt nmap in diesem Fall für einen Scan aus? Wie viele Ports werden gescannt. Scanne mit diesem Befehl die metasploitable VM   
### Was macht der Befehl:    
-Pn        Deaktiviert die Host-Erkennung (Ping-Scan). Nmap geht davon aus, dass das Ziel erreichbar ist.
-sS        Führt einen TCP SYN Scan (Half-open Scan) aus, um offene TCP-Ports zu finden.
-sV        Ermittelt die laufenden Dienste und deren Versionen auf den offenen Ports.
-sC        Führt die Standard-NSE-Skripte aus (z. B. Banner-Grabbing, einfache Sicherheitsprüfungen).
-oN        Speichert das Scan-Ergebnis im normalen Textformat in der Datei nmap_default.txt.
10.10.92.153  Ziel-IP-Adresse (z. B. Metasploitable-VM).  
### Befehl für Scanning:    
`$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.18.51`   
Scannen von Kali auf Metasploitable:     
![](https://github.com/user-attachments/assets/ff36ff40-af60-4899-a344-089a3a7b943c)    
### Offene Ports:    
z.B.: 21,22,23,25,53,80,111    

## Übung (vulnerability scan)  
nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts.   
### Aufgabe 1: Verwende die Option -sC um die Standard-Skripte auszuführen, zusätzlich beschränkt auf die 100 häufigsten Ports (Option -F) aus.   
Anmerkung: nmap kann wertvolle Hinweise auf Schwachstellen liefern, ein vollwertiger vulnerability scaner ist es allerdings nicht, dafür gibt es eigene darauf spezialisierte Tools (z.B.: gvm … Greenbone Vulnerability Manager).   
### Lösung Aufgabe 1:    
Befehle: `$ sudo nmap -sC -F 192.168.18.51 `   
![](https://github.com/user-attachments/assets/47e8744d-cc08-40e6-ba7f-1ce75bfbaaa7)   

### Aufgabe 2: verwende die Option --script um ausgewählte Skripte zu starten. Z.B. --script http-title,mysql-info,banner. Probiere ca. 5 Skripte aus. Nimm die Metasploitable VM als Ziel.   
### http-title → liest den Titel von Webanwendungen aus
Befehl: `$ sudo nmap --script http-title  192.168.18.51`    
![](https://github.com/user-attachments/assets/a6c869ec-e9a4-4d82-8954-16a31911c4fd)    
### mysql-info → sammelt Informationen über den MySQL-Dienst   
Befehl: `─$ sudo nmap --script mysql-info  192.168.18.51`     
### banner → liest Service-Banner aus (Versionen, Hinweise)
Befehl: ` $ sudo nmap --script banner  192.168.18.51`   
### ftp-anon → prüft, ob anonymer FTP-Login erlaubt ist   
Befehl: `$ sudo nmap --script ftp-anon  192.168.18.51`     
### nbstat → Liefert NetBIOS-Informationen (Name, Domain, MAC)     
Befehl: `$ sudo nmap --script nbstat  192.168.18.51`     
![](https://github.com/user-attachments/assets/2a66c182-8934-4b77-9f2d-5883a00bc016)    

### Aufgabe 3: finde ein weiteres Skript das bei der Metasploitable VM sinnvolle Ergebnisse liefert
vsftpd-backdoor   
vsftpd-backdoor ist ein Nmap-NSE-Skript, das prüft, ob der FTP-Dienst vsftpd Version 2.3.4 mit einer bekannten Backdoor läuft. Diese Schwachstelle ist in der Metasploitable-VM absichtlich vorhanden. Das Skript erkennt die verwundbare Version und weist darauf hin, dass über die Backdoor ein unautorisierter Zugriff möglich ist.

### Aufgabe 4: Die nmap Skripte sind in Kategorien eingeteilt, es gibt z.B. eine Kategorie vuln (Siehe Kategorie vuln). Verwende die Option --script=vuln um alle Skripte dieser Kategorie zu starten. Verwende als Ziel die Metasploitable VM. Dieser Scan dauert sehr lange, schränke ein auf die Ports von FTP und HTTP.
Befehl: `sudo nmap --script=vuln -p 21,80 192.168.18.51`   
21 = Port FTP   
80 = Port HTTP   
![](https://github.com/user-attachments/assets/eded81ef-3a8e-4e5f-8685-d5df2d34f1c8)

## Übung (very safe FTP backdoor)
Der vuln-scan auf Metasploitable Port 21/FTP liefert Hinweis auf eine Schwachstelle, verwende die angezeigte CVE Nummer um genaueres über diese herauszufinden.
### IDs:  CVE:CVE-2011-2523  BID:48539     
Ausgabe CVE-Number: ![](https://github.com/user-attachments/assets/c39c1560-4ae9-4c2d-941a-441b99296bdb)      
Was bedeutet diese Zahl: Eine CVE-Nummer ist eine eindeutige Kennung für eine bekannte Sicherheitslücke. Sie besteht aus dem Jahr der Veröffentlichung und einer laufenden Nummer und dient dazu, Schwachstellen eindeutig zu identifizieren und zu referenzieren. -> Ermöglicht das Ausnutzen einer Backdoor im FTP-Dienst. Die CVE-Nummer selbst beschreibt nicht die Art oder Schwere der Lücke, sondern dient als Referenz-ID, um weltweit eindeutig über dieselbe Schwachstelle zu sprechen.    


# Login Vulnerabilites

## Übung (rlogin vulnerability)
### Informiere dich über rlogin und mögliche Angriffe/Fehlkonfiguration in diesem Zusammenhang
rlogin ist ein veralteter Remote-Login-Dienst, der Benutzern den Zugriff auf ein anderes System ermöglicht. Er überträgt Daten unverschlüsselt und vertraut auf Host- und Benutzerzuordnung statt auf sichere Authentifizierung. Häufige Fehlkonfigurationen wie .rhosts-Dateien, vertrauenswürdige Hosts oder erlaubter root-Login ermöglichen es Angreifern, sich ohne Passwort anzumelden. Deshalb gilt rlogin als unsicher und sollte durch SSH ersetzt werden. Besonders kritisch ist es, wenn root‑Login über rlogin erlaubt ist. Angreifer können diese Vertrauensbeziehungen ausnutzen, um sich unautorisiert Zugriff bis hin zu Root-Rechten zu verschaffen. 

### Prüfe mit nmap ob der rlogin zugeordnete Port bei Metasploitable offen ist.     
Port: 513       
Befehl: `sudo nmap -p 513 192.168.18.51`      
![](https://github.com/user-attachments/assets/e27fd7bd-a02b-4ea8-acf7-74bf2ae608be)   
-> Port ist offen         
  
### Nutze diese Sicherheitslücke aus um dich als root mit rlogin einzuloggen.     
Befehl: `rlogin -l root 192.168.18.51`      
![](https://github.com/user-attachments/assets/ae3bbf49-e4d3-4c62-92d4-8f9fec56ac5e)    
Erklärung:       
rlogin → Remote‑Login‑Client      
-l root → Anmeldung als Benutzer root -> -l steht dabei für den login namen      
192.168.18.51 → Metasploitable‑IP         

### Welche Fehlkonfiguration ermöglicht diesen exploit?      
Die Fehlkonfiguration besteht darin, dass rlogin Root‑Anmeldungen ohne Passwort erlaubt, weil vertrauenswürdige Hosts (.rhosts) aktiviert sind. Dadurch kann man sich direkt als root einloggen.           

### Ändere die Konfiguration von Metasploitable ab um die Sicherheitslücke zu schließen.      
Befehle:    
`sudo update-inetd --disable login` -> rlogin-Dienst abschalten    
`sudo nano /etc/hosts.equiv -> `Überprüfen, ob es die Datei gibt    
`sudo rm -f /root/.rhosts` -> Root-spezifische Trust-Datei entfernen    
`sudo apt-get remove rsh-server rsh-client` -> r-Services komplett entfernen    
`sudo reboot` -> Netasploitable rebooten    

Überprüfung:      
![](https://github.com/user-attachments/assets/b62845c4-3daa-41db-8bf9-076eae7872eb)    
![](https://github.com/user-attachments/assets/6d3bea5e-e708-48fa-8199-35fa217d6ab2)    

## Übung (Online password guessing)
Führe einen online password guessing attack auf den rlogin und ssh Port von Metasploitable aus. Verwende dafür hydra ein geeignetes und bereits in Kali installiertes Penetration Testing Tool.
Verwende die folgenden Listen:
```
#,Benutzername
1,msfadmin
2,user
3,root
4,admin
5,postgres
6,ftp
7,daemon
8,operator
9,sysadmin
10,support
11,test
12,webmaster
13,guest
14,ubuntu
15,mysql
```
```
#,Passwort
1,msfadmin
2,user
3,toor
4,password
5,postgres
6,123456
7,12345678
8,qwerty
9,admin
10,default
11,pass
12,welcome
13,changeme
14,secret
15,test
```
Welche erfolgreichen user/password Kombinationen kannst du finden?


