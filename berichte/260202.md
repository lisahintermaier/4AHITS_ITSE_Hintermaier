Name: Lisa Hintermaier
Klasse: 4 AHITS
Datum: 02.02.2026
Fach: ITSE- Übungen 

# very safe FTP backdoor
Vorgeschickte:     
In dieser Übung starten wir einen Angriff auf die matasploitable VM mit dem Tool metasploit.
Mittels der nmap Skripts konnten wir feststellen dass vsFTPd version 2.3.4 eine Sicherheitslücke enthält (backdoor).
In weiterer Folge nutzen wir ein exploit Modul von metasploit um diese Sicherheitslücke auszunutzen.     
Metasploit ist ein Werkzeugkasten für Hacker und Penetration-Tester: damit kann man Schwachstellen suchen, Exploits ausprobieren, payloads (shell-code) bauen 
und nach einem erfolgreichen Einbruch weiterforschen (Meterpreter).

## Info: in der 1 Doppelstunde war ich krank.    
   
## Gemeinsame Übung (Metasploit)    
Befehl: $ msfconsole    
Zur verwaltung von Modulen   
![](https://github.com/user-attachments/assets/163fa35a-e156-42bf-9571-47fede73f175)    

### SSH-Version     
Befehl: search -h     
![](https://github.com/user-attachments/assets/2ec4406c-f32b-427e-b74a-b41466d0d100)    

Befehl: search ssh    
![](https://github.com/user-attachments/assets/4849f817-8a94-4ea5-a7ce-2103e708a912)
  
Befehl: search scanner/ssh   
![](https://github.com/user-attachments/assets/680f4aa9-46fc-4f2f-827f-6d282d7febc0)      

Befehl: search type:auxiliary name:ssh      
![](https://github.com/user-attachments/assets/fd84ee9e-b746-4332-b693-7e4e3be5f585)       

Befehl: info auxiliary/scanner/ssh/ssh_version       
![](https://github.com/user-attachments/assets/50cc5c7b-7033-4d39-8e15-793de1fa35fd)     
 
Befehl: use auxiliary/scanner/ssh/ssh_version   
![](https://github.com/user-attachments/assets/39069675-ba42-4c85-9e9a-01ea2d772b4e)       

Befehl: options   
![](https://github.com/user-attachments/assets/ca69dccc-4e5e-4a9f-9ed0-8d31d4a3bdb0)    

Befehl: set RHOSTS <target IP>          
![](https://github.com/user-attachments/assets/8280b537-a611-4ec5-9164-4202ed655514)           

Befehl: run       
![](https://github.com/user-attachments/assets/862e9de6-4fc8-4629-b90b-a0eafb537996)     

### HTTP title     
Befehl: use auxiliary/scanner/http/title     
![](https://github.com/user-attachments/assets/d0f1a152-401d-4578-89aa-1932e31ad7b9)     

Befehl: info    
![](https://github.com/user-attachments/assets/a80a3fce-70fc-4cca-96ec-1831d9b5299a)    

Befehl: options      
![](https://github.com/user-attachments/assets/971c8a6e-8bba-4297-b0d5-66bc07327030)     

Befehl: set RHOSTS <target IP>    
![](https://github.com/user-attachments/assets/2590819f-f368-4642-b412-c2b20889fd35)    

Befehl: run   
![](https://github.com/user-attachments/assets/bbedcdd0-f2f8-4fc2-b989-cde9f43f4733)    

Befehl: set RHOSTS www.orf.at   
![](https://github.com/user-attachments/assets/c5f7571b-1b65-4966-aef9-1781b03fe693)    

Befehl: run    
![](https://github.com/user-attachments/assets/f507408f-bb54-4547-8314-74813c5d2fae)    

Befehl: set RHOSTS www.htl-braunau.at und          
Befehl: run      
![](https://github.com/user-attachments/assets/b1fd69e4-5723-4d30-a71f-bf495985631d)      


## Übung (msf Basics)    
Probiere alle besprochenen bzw. open beschriebenen msf Befehle noch einmal aus und erstelle ein kurzes Cheatsheet zur Bedienung von metasploit.     

<table border="1" cellpadding="5" cellspacing="0">
    <tr>
        <th>Befehl</th>
        <th>Beschreibung</th>
    </tr>
    <tr>
        <td>search -h</td>
        <td>Zeigt Hilfe für den search-Befehl</td>
    </tr>
    <tr>
        <td>search ssh</td>
        <td>Sucht nach allen Modulen mit Bezug zu SSH</td>
    </tr>
    <tr>
        <td>search scanner/ssh</td>
        <td>Sucht nach SSH-Scanner-Modulen</td>
    </tr>
    <tr>
        <td>search type:auxiliary name:ssh</td>
        <td>Sucht Auxiliary-Module mit SSH im Namen</td>
    </tr>
    <tr>
        <td>info auxiliary/scanner/ssh/ssh_version</td>
        <td>Zeigt Informationen zum SSH-Version-Scanner</td>
    </tr>
    <tr>
        <td>use auxiliary/scanner/ssh/ssh_version</td>
        <td>Lädt das SSH-Version-Scanner-Modul</td>
    </tr>
    <tr>
        <td>use auxiliary/scanner/http/title</td>
        <td>Lädt das HTTP-Title-Scanner-Modul</td>
    </tr>
    <tr>
        <td>options</td>
        <td>Zeigt die Optionen des aktuellen Moduls</td>
    </tr>
    <tr>
        <td>set RHOSTS &lt;target IP&gt;</td>
        <td>Setzt das Ziel (IP-Adresse oder Domain)</td>
    </tr>
    <tr>
        <td>set RHOSTS www.orf.at</td>
        <td>Setzt eine Domain als Ziel</td>
    </tr>
    <tr>
        <td>set RHOSTS www.htl-braunau.at</td>
        <td>Setzt eine weitere Domain als Ziel</td>
    </tr>
    <tr>
        <td>run</td>
        <td>Führt das aktuell geladene Modul aus</td>
    </tr>
    <tr>
        <td>back</td>
        <td>Verlässt das aktuelle Modul</td>
    </tr>
    <tr>
        <td>help / ?</td>
        <td>Zeigt Hilfe an</td>
    </tr>
    <tr>
        <td>exit</td>
        <td>Beendet Metasploit</td>
    </tr>
</table>      

Der Befehl setg (set global) ist in unserem Zusammenhang auch sehr praktisch, recherchiere dazu.
### setg     
Der Befehl setg wird verwendet, um eine Option global in Metasploit zu setzen. Im Gegensatz zu set gilt der Wert dann für alle Module, die danach geladen werden. Typische Beispiele sind setg RHOSTS oder setg LHOST, um Ziel- oder eigene IP nicht jedes Mal neu eingeben zu müssen. Die global gesetzten Werte können mit getg angezeigt und mit unsetg wieder entfernt werden.    

### msfvenom    
msfvenom ist ein Tool von Metasploit zur Erstellung von Payloads, zum Beispiel für Reverse Shells. Es kombiniert Payload, Encoder und Ausgabeformat in einem einzigen Befehl. Die erzeugten Dateien können verschiedene Formate haben, etwa .exe, .elf oder .raw. msfvenom wird häufig genutzt, um Payloads für Tests oder Exploits vorzubereiten.   

### Meterpreter    
Meterpreter ist ein erweiterter Payload, der nach erfolgreicher Ausnutzung eines Systems eine interaktive Sitzung bereitstellt. Er läuft im Speicher und hinterlässt meist keine Dateien auf dem Zielsystem. Mit Meterpreter kann man unter anderem Prozesse anzeigen, Dateien übertragen oder Systeminformationen auslesen. Er wird häufig verwendet, um ein kompromittiertes System weiter zu analysieren.     

## Übung (nmap FTP scan)
### Aufgabe: Wiederhole den nmap vuln scan auf den FTP Port. Verwende:    
 
Option --script=vuln (Diese Skripte sind “intrusive” und werden daher nicht über die Optionen -sC oder -A aufgerufen.)   
Option -p zum Einschränken auf den FTP Port    
### Befehl: nmap -p 21 --script=vuln 192.168.1.52       
![](https://github.com/user-attachments/assets/fcf76896-34cd-46e8-91d3-fea03c9991ea)        

Findet nmap die Sicherheitslücke? Recherchiere mit Hilfe der CVE Nummer über diese Sicherheitslücke.     
-> Ja die Sicherheitslücke ist die CVE nummer: CVE-2011-07-03     
Sicherheitslücke:  CVE-2011-2523 ist eine kritische Sicherheitslücke im FTP-Server vsftpd 2.3.4.
Diese Version des FTP-Servers wurde zwischen dem 30. Juni und dem 3. Juli 2011 mit einer bösartigen Backdoor ausgeliefert, die einen Shell-Zugang öffnet, wenn ein spezieller Login-Trigger verwendet wird.       
Wenn ein System den kompromittierten vsftpd-Server 2.3.4 betreibt, kann ein Angreifer über Port 6200 eine Shell öffnen und so praktisch vollständigen Zugriff erhalten.    

Recherchiere warum diese Skripte als intrusive bezeichnet werden, warum werden diese bei -sC oder -A nicht ausgeführt?      
- Die vuln-Skripte gelten als intrusive, weil sie aktiv versuchen, Sicherheitslücken auszunutzen oder ungewöhnliche Anfragen an den Dienst senden. Dabei kann es passieren, dass Dienste abstürzen, Logs erzeugt werden oder Systeme beeinträchtigt werden.     
- Die Optionen -sC und -A führen nur sichere Default-Skripte aus. Intrusive Skripte werden absichtlich ausgeschlossen, da sie Systeme stören oder beschädigen könnten. Um unbeabsichtigte Auswirkungen zu vermeiden, müssen vuln-Skripte bewusst mit --script=vuln gestartet werden.      


## Übung (msf FTP Version herausfinden)    
### Angabe: In dieser Übung findest du mit Hilfe eines msf Moduls ähnliche Informationen wie mit dem vorherigen nmap scan.    
Suche nach einem msf Modul mit dem die Version des FTP Servers ermittelt werden kann, du findest dies in der Kategorie scanner.     
Verwende dieses Modul um die auf Metasploitable installierte FTP Version herauszufinden.     

### Lösung:     
Passendes Modul suchen:       
![](https://github.com/user-attachments/assets/be014cf1-6ca0-4178-a8f4-48edea72c7b9)              
Hier kann man die Zeile lesen mit dem Befehl: auxiliary/scanner/ftp/ftp_version         
![](https://github.com/user-attachments/assets/03b5350a-7be9-4dbe-a4c0-92d6f8a5aca4)       
Optionen anzeigen und Ziel setzten:         
![](https://github.com/user-attachments/assets/30f680c4-4e0c-4a75-b983-9356cf9a1cbd)            
Ergebnis:         
![](https://github.com/user-attachments/assets/4f4eb794-2421-4573-8281-ed44765910ce)      
### Anmerkung: Bei mir kam die gewünschte Ausgabe: z.b.: FTP Banner: '220 (vsFTPd 2.3.4)' nicht. -> Wurde mit Ihnen besprochen.       

## Übung (msf vsftpd exploit)     
Voraussetzung: Setze Kali und Metasploitable in den NAT Modus.     
-> Gemacht!     
Starte metasploit aus dem Terminal mit msfconsole (metasploit framework console)
help zeigt einen Hilfetext an.

Verwende search um ein metasploit Modul zu finden dass einen exploit für diese Backdoor zur Verfügung stellt. Hinweis: Suche nach vsftpd     
vsftp-backdoor Suchen:      
![](https://github.com/user-attachments/assets/dd6cef3c-7d28-4d11-9b4a-d8f69e844ece)         
Gefundene: exploit/unix/ftp/vsftpd_234_backdoor        
Modul aktivieren:      
![](https://github.com/user-attachments/assets/2256fab0-7731-4ce1-9c58-51e6562e629e)     

Modul-Informationen anzeigen:         
![](https://github.com/user-attachments/assets/6ec9bd0f-337a-4349-a31f-98355ac5c7d0)       
Optionen setzen:     
![](https://github.com/user-attachments/assets/df521a74-a8fe-4091-b0c3-a6ca327700ea)         
Auführen: 
192.168.112.128  




Aktiviere dieses Modul mit use.

Die Anzeige sollte nun so aussehen:

[*] No payload configured, defaulting to cmd/unix/interact
msf6 exploit(unix/ftp/...) > 

Verwende info um Informationen zum aktivierten Modul anzuzeigen. Lies die “Description” durch und finde heraus welche Optionen dieses Modul unterstützt und wie diese gesetzt werden müssen. Setze die notwendigen Optionen.

Verwende den Befehl run um das aktive Modul auszuführen. Es startet eine shell. Hinweis: es wird kein Prompt angezeigt, die Zeile sieht “leer” aus. Verifiziere, dass diese am Metasploit System läuft. Welche Rechte hat diese shell (welcher user)?

Hinterlasse eine Nachricht you have been hacked!die beim nächsten Einloggen dem User msfadmin automatisch angezeigt wird.



 



